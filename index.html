<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Alcotell.GitHub.io by alcoadfasdftell</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
      <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.4.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.4.0/firebase-database.js"></script>

    <form onsubmit="meraFunction()">
        <input type="text" placeholder="Email" id="emailID" />
        <input type="password" placeholder="Password" id="pass" />
        <input type="submit" value="SIGN IN" />
    </form>

    <form onsubmit="meraFunction2()">
        <input type="text" placeholder="Email" id="emailID2" />
        <input type="password" placeholder="Password" id="pass2" />
        <input type="submit" value="SIGN UP" />
    </form>

    <form onsubmit="meraFunction3()">
        <input type="text" placeholder="Name" id="userName" />
        <input type="date"  id="date"/>
        <select id="gender">
            <option value="Male">Male</option>
            <option value="Female">Female</option>
        </select>
        <select id="country">
	<option value="AFG">Afghanistan</option>
	<option value="ALA">Ã…land Islands</option>
	<option value="ALB">Albania</option>
	<option value="DZA">Algeria</option>

</select>
        <input type="submit" value="SAVE" />
    </form>



  <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyAe3CjDwV9qxXZVmlPpAym-epdQVLNAZD4",
      authDomain: "aloctell.firebaseapp.com",
      databaseURL: "https://aloctell.firebaseio.com",
      storageBucket: "",
      messagingSenderId: "810891375354"
    };
    firebase.initializeApp(config);
  </script>
  <script>
    var meraFunction = function() {
        event.preventDefault();
        var database = firebase.database();
        var starCountRef = firebase.database().ref('Authorize');
        var kaamKa = undefined;
        starCountRef.once('value', function(snapshot) {
            var allResults = snapshot.val();
            for(keyValue in allResults) {
                if(allResults[keyValue] === document.getElementById('emailID').value) {
                    kaamKa = keyValue;
                }
                else {

                }
            }
            if(kaamKa) {
                var starCountRef1 = firebase.database().ref('Details/' + kaamKa);
                starCountRef1.once('value', function(snapshot) {
                    var allResults1 = snapshot.val();
                    if(allResults1.pass === document.getElementById('pass').value) {
                        console.log("SUCCESS");
                    }
                    else {
                        console.log("Failure");
                    }
                });
            }
        });
    }
    var meraFunction2 = function() {
        event.preventDefault();
        var database = firebase.database();
        var starCountRef = firebase.database().ref('Authorize');
        var alreadyExists = false;
        starCountRef.once('value', function(snapshot) {
            var allResults = snapshot.val();
            for(keyValue in allResults) {
                if(allResults[keyValue] === document.getElementById('emailID2').value) {
                    alreadyExists = true;
                }
                else {

                }
            }
            if(alreadyExists) {
                console.log("USER ALREADY EXISTS");
            }
            else {
                newKey = firebase.database().ref().child('Authorize').push().key;
                var updates = {};
                updates['/Authorize/' + newKey] = document.getElementById('emailID2').value;
                firebase.database().ref().update(updates);

                firebase.database().ref('Details/' + newKey).set({
                    pass: document.getElementById('pass2').value,
                });
            }
        });
    }
    var meraFunction3 = function() {
        event.preventDefault();
        var database = firebase.database();
        firebase.database().ref('Details/' + newKey).set({
            Name: document.getElementById('userName').value,
            DOB: document.getElementById('date').value,
            Gender: document.getElementById('gender').value,
            Country: document.getElementById('country').value,
        });
    }
  </script>
  </body>
</html>
